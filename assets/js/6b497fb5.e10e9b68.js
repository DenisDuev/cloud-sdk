"use strict";(self.webpackChunksap_cloud_sdk_documentation=self.webpackChunksap_cloud_sdk_documentation||[]).push([[1694,5789,7859,2514,9888,5537],{28747:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=t(74848),s=t(28453);const r={},i=void 0,o={id:"environments/code/Dockerfile",title:"Dockerfile",description:"",source:"@site/docs-js/environments/code/Dockerfile.mdx",sourceDirName:"environments/code",slug:"/environments/code/Dockerfile",permalink:"/cloud-sdk/docs/js/environments/code/Dockerfile",draft:!1,unlisted:!1,editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs-js/environments/code/Dockerfile.mdx",tags:[],version:"current",frontMatter:{}},c={},l=[];function d(e){const n={code:"code",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-Dockerfile",metastring:'title="Dockerfile"',children:'FROM node:14-alpine\n\nWORKDIR /workdir\n\nCOPY /deployment /workdir\n\nRUN ["npm", "install", "--unsafe-perm"]\n\nEXPOSE 3000\nCMD ["npm", "run", "start:prod"]\n'})})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},51504:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=t(74848),s=t(28453),r=t(11470),i=t(19365);const o={},c=void 0,l={id:"environments/code/kyma-app-tabs",title:"kyma-app-tabs",description:'<Tabs defaultValue="deployment"',source:"@site/docs-js/environments/code/kyma-app-tabs.mdx",sourceDirName:"environments/code",slug:"/environments/code/kyma-app-tabs",permalink:"/cloud-sdk/docs/js/environments/code/kyma-app-tabs",draft:!1,unlisted:!1,editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs-js/environments/code/kyma-app-tabs.mdx",tags:[],version:"current",frontMatter:{}},d={},u=[];function p(e){const n={code:"code",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(r.A,{defaultValue:"deployment",values:[{label:"values.yaml",value:"values"},{label:"Chart.yaml",value:"Chart"},{label:"configmap.yaml",value:"configmap"},{label:"deployment.yaml",value:"deployment"},{label:"service.yaml",value:"service"}],children:[(0,a.jsx)(i.A,{value:"values",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"image:\n  repository: <YOUR_REPO>/k8s-e2e-app:latest # replace <YOUR_REPO> with your Docker repository\n  tag: latest\nresources:\n  requests:\n    memory: '256Mi'\n    cpu: '500m'\n  limits:\n    memory: '512Mi'\n    cpu: '1000m'\n"})})}),(0,a.jsx)(i.A,{value:"Chart",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v2\nname: app-chart\ndescription: A Helm chart for Kubernetes\n\n# A chart can be either an 'application' or a 'library' chart.\n#\n# Application charts are a collection of templates that can be packaged into versioned archives\n# to be deployed.\n#\n# Library charts provide useful utilities or functions for the chart developer. They're included as\n# a dependency of application charts to inject those utilities and functions into the rendering\n# pipeline. Library charts do not define any templates and therefore cannot be deployed.\ntype: application\n\n# This is the chart version. This version number should be incremented each time you make changes\n# to the chart and its templates, including the app version.\n# Versions are expected to follow Semantic Versioning (https://semver.org/)\nversion: 0.1.0\n\n# This is the version number of the application being deployed. This version number should be\n# incremented each time you make changes to the application. Versions are not expected to\n# follow Semantic Versioning. They should reflect the version the application is using.\n# It is recommended to use it with quotes.\nappVersion: '1.0.0'\n"})})}),(0,a.jsx)(i.A,{value:"configmap",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: {{ include "app-chart.fullname" . }}-config\ndata:\n  cloud_destination: {{ .Values.cloudDestination | quote }}\n  onpremise_destination: {{ .Values.onPremiseDestination | quote }}\n  principal_propagation_destination: {{ .Values.principalPropagationDestination | quote }}\n'})})}),(0,a.jsx)(i.A,{value:"service",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Service\nmetadata:\n  name: {{ include "app-chart.fullname" . }}-svc\n  labels:\n    {{- include "app-chart.labels" . | nindent 4 }}\nspec:\n  ports:\n    - port: 8080\n      targetPort: 3000\n  selector:\n    {{- include "app-chart.selectorLabels" . | nindent 4 }}\n'})})}),(0,a.jsx)(i.A,{value:"deployment",className:"code-block-height-js thin-scrollbar",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: {{ include "app-chart.fullname" . }}\n  labels:\n    {{- include "app-chart.labels" . | nindent 4 }}\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      {{- include "app-chart.selectorLabels" . | nindent 6 }}\n  template:\n    metadata:\n      labels:\n        {{- include "app-chart.selectorLabels" . | nindent 8 }}\n    spec:\n      {{- with .Values.imagePullSecrets }}\n      imagePullSecrets:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n      serviceAccountName: {{ include "app-chart.serviceAccountName" . }}\n      containers:\n        - name: {{ .Chart.Name }}\n          image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"\n          ports:\n            - containerPort: 3000\n          resources:\n            {{- toYaml .Values.resources | nindent 12 }}\n          env:\n            - name: CLOUD_DESTINATION\n              valueFrom:\n                configMapKeyRef:\n                  name: {{ include "app-chart.fullname" . }}-config\n                  key: cloud_destination\n            - name: ONPREMISE_DESTINATION\n              valueFrom:\n                configMapKeyRef:\n                  name: {{ include "app-chart.fullname" . }}-config\n                  key: onpremise_destination\n            - name: PRINCIPAL_PROPAGATION_DESTINATION\n              valueFrom:\n                configMapKeyRef:\n                  name: {{ include "app-chart.fullname" . }}-config\n                  key: principal_propagation_destination\n          volumeMounts:\n            - name: destination-volume\n              mountPath: {{ printf "/etc/secrets/sapcp/destination/%s" .Values.destinationBinding | quote }}\n              readOnly: true\n            - name: xsuaa-volume\n              mountPath: {{ printf "/etc/secrets/sapcp/xsuaa/%s" .Values.xsuaaBinding | quote }}\n              readOnly: true\n            - name: connectivity-volume\n              mountPath: {{ printf "/etc/secrets/sapcp/connectivity/%s" .Values.connectivityBinding | quote }}\n              readOnly: true\n      volumes:\n        - name: destination-volume\n          secret:\n            secretName: {{ .Values.destinationBinding | quote }}\n        - name: xsuaa-volume\n          secret:\n            secretName: {{ .Values.xsuaaBinding | quote }}\n        - name: connectivity-volume\n          secret:\n            secretName: {{ .Values.connectivityBinding | quote }}\n'})})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},36833:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=t(74848),s=t(28453),r=t(11470),i=t(19365);const o={},c=void 0,l={id:"environments/code/kyma-approuter-tabs",title:"kyma-approuter-tabs",description:'<Tabs defaultValue="deployment"',source:"@site/docs-js/environments/code/kyma-approuter-tabs.mdx",sourceDirName:"environments/code",slug:"/environments/code/kyma-approuter-tabs",permalink:"/cloud-sdk/docs/js/environments/code/kyma-approuter-tabs",draft:!1,unlisted:!1,editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs-js/environments/code/kyma-approuter-tabs.mdx",tags:[],version:"current",frontMatter:{}},d={},u=[];function p(e){const n={code:"code",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(r.A,{defaultValue:"deployment",values:[{label:"values.yaml",value:"values"},{label:"Chart.yaml",value:"Chart"},{label:"configmap.yaml",value:"configmap"},{label:"deployment.yaml",value:"deployment"},{label:"service.yaml",value:"service"}],children:[(0,a.jsx)(i.A,{value:"values",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"xsuaaBinding:\n  config:\n    idp:\n    pattern:\n  image:\n    repository: <YOUR_REPO>/k8s-approuter:latest # replace <YOUR_REPO> with your Docker repository\n    tag: latest\n  resources:\n    requests:\n      memory: '256Mi'\n      cpu: '500m'\n    limits:\n      memory: '512Mi'\n      cpu: '1000m'\n"})})}),(0,a.jsx)(i.A,{value:"Chart",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v2\nname: approuter-chart\ndescription: A Helm chart for Kubernetes\n\n# A chart can be either an 'application' or a 'library' chart.\n#\n# Application charts are a collection of templates that can be packaged into versioned archives\n# to be deployed.\n#\n# Library charts provide useful utilities or functions for the chart developer. They're included as\n# a dependency of application charts to inject those utilities and functions into the rendering\n# pipeline. Library charts do not define any templates and therefore cannot be deployed.\ntype: application\n\n# This is the chart version. This version number should be incremented each time you make changes\n# to the chart and its templates, including the app version.\n# Versions are expected to follow Semantic Versioning (https://semver.org/)\nversion: 0.1.0\n\n# This is the version number of the application being deployed. This version number should be\n# incremented each time you make changes to the application. Versions are not expected to\n# follow Semantic Versioning. They should reflect the version the application is using.\n# It is recommended to use it with quotes.\nappVersion: '1.0.0'\n"})})}),(0,a.jsx)(i.A,{value:"configmap",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: {{ include "approuter-chart.fullname" . }}-config\ndata:\n  {{- if .Values.config.idp }}\n  xs-app.json: {{ printf "{\\"welcomeFile\\":\\"/web-pages/index.html\\",\\"routes\\":[{\\"source\\":\\"/backend-app/(.*)\\",\\"target\\":\\"$1\\",\\"destination\\":\\"backend\\",\\"identityProvider\\":\\"%s\\"},{\\"source\\":\\"/web-pages/(.*)\\",\\"target\\":\\"$1\\",\\"localDir\\":\\"static-resources\\",\\"identityProvider\\":\\"%s\\"}]}" .Values.config.idp .Values.config.idp | toPrettyJson }}\n  {{- else }}\n  xs-app.json: {{ .Values.config.json | toPrettyJson | quote }}\n  {{ end -}}\n'})})}),(0,a.jsx)(i.A,{value:"service",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Service\nmetadata:\n  name: {{ include "approuter-chart.fullname" . }}-svc\n  labels:\n    {{- include "approuter-chart.labels" . | nindent 4 }}\nspec:\n  ports:\n    - port: 8080\n      targetPort: 5000\n  selector:\n    {{- include "approuter-chart.selectorLabels" . | nindent 4 }}\n'})})}),(0,a.jsx)(i.A,{value:"deployment",className:"code-block-height-js thin-scrollbar",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: {{ include "approuter-chart.fullname" . }}\n  labels:\n    {{- include "approuter-chart.labels" . | nindent 4 }}\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      {{- include "approuter-chart.selectorLabels" . | nindent 6 }}\n  template:\n    metadata:\n      labels:\n        {{- include "approuter-chart.selectorLabels" . | nindent 8 }}\n    spec:\n      {{- with .Values.imagePullSecrets }}\n      imagePullSecrets:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n      serviceAccountName: {{ include "approuter-chart.serviceAccountName" . }}\n      containers:\n        - name: {{ .Chart.Name }}\n          image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"\n          ports:\n            - containerPort: 5000\n          resources:\n            {{- toYaml .Values.resources | nindent 12 }}\n          env:\n            - name: PORT\n              value: "5000"\n            - name: destinations\n              value: \'[{"name":"backend", "url":"http://{{ printf "%s-%s" .Release.Name "app-chart" | trunc 63 | trimSuffix "-" }}-svc:8080/", "forwardAuthToken": true}]\'\n            - name: TENANT_HOST_PATTERN\n              value: {{ .Values.config.pattern | quote }}\n          volumeMounts:\n            - name: xsuaa-volume\n              mountPath: {{ printf "/etc/secrets/sapcp/xsuaa/%s" .Values.xsuaaBinding | quote}}\n              readOnly: true\n            - name: approuter-volume\n              mountPath: "/usr/src/app/xs-app.json"\n              subPath: "xs-app.json"\n              readOnly: true\n      volumes:\n        - name: xsuaa-volume\n          secret:\n            secretName: {{ .Values.xsuaaBinding | quote}}\n        - name: approuter-volume\n          configMap:\n            name: {{ include "approuter-chart.fullname" . }}-config\n            items:\n              - key: xs-app.json\n                path: xs-app.json\n\n\n'})})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},1936:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=t(74848),s=t(28453);const r={},i=void 0,o={id:"environments/code/operator-destination-service",title:"operator-destination-service",description:"",source:"@site/docs-js/environments/code/operator-destination-service.mdx",sourceDirName:"environments/code",slug:"/environments/code/operator-destination-service",permalink:"/cloud-sdk/docs/js/environments/code/operator-destination-service",draft:!1,unlisted:!1,editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs-js/environments/code/operator-destination-service.mdx",tags:[],version:"current",frontMatter:{}},c={},l=[];function d(e){const n={code:"code",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",metastring:'title="operator-destination-service.yml"',children:"apiVersion: services.cloud.sap.com/v1alpha1\nkind: ServiceInstance\nmetadata:\n  name: operator-destination-service\nspec:\n  serviceOfferingName: destination\n  servicePlanName: lite\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",metastring:'title="operator-destination-binding.yml"',children:"apiVersion: services.cloud.sap.com/v1alpha1\nkind: ServiceBinding\nmetadata:\n  name: operator-destination-service\nspec:\n  serviceInstanceName: operator-destination-service\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},59782:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=t(74848),s=t(28453);const r={},i=void 0,o={id:"environments/code/operator-xsuaa-service",title:"operator-xsuaa-service",description:"",source:"@site/docs-js/environments/code/operator-xsuaa-service.mdx",sourceDirName:"environments/code",slug:"/environments/code/operator-xsuaa-service",permalink:"/cloud-sdk/docs/js/environments/code/operator-xsuaa-service",draft:!1,unlisted:!1,editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs-js/environments/code/operator-xsuaa-service.mdx",tags:[],version:"current",frontMatter:{}},c={},l=[];function d(e){const n={code:"code",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",metastring:'title="operator-xsuaa-service.yml"',children:"apiVersion: services.cloud.sap.com/v1alpha1\nkind: ServiceInstance\nmetadata:\n  name: operator-xsuaa-service\nspec:\n  serviceOfferingName: xsuaa\n  servicePlanName: application\n  parameters:\n    xsappname: kubernetes-xsuaa\n    tenant-mode: shared\n    scopes:\n      - name: '$XSAPPNAME.Callback'\n        description: 'With this scope set, the callbacks for tenant onboarding, offboarding and getDependencies can be called.'\n        grant-as-authority-to-apps:\n          - $XSAPPNAME(application,sap-provisioning,tenant-onboarding)\n    role-templates:\n      - name: TOKEN_EXCHANGE\n        description: Token exchange\n        scope-references:\n          - uaa.user\n      - name: 'MultitenancyCallbackRoleTemplate'\n        description: 'Call callback-services of applications'\n        scope-references:\n          - '$XSAPPNAME.Callback'\n    oauth2-configuration:\n      grant-types:\n        - authorization_code\n        - client_credentials\n        - password\n        - refresh_token\n        - urn:ietf:params:oauth:grant-type:saml2-bearer\n        - user_token\n        - client_x509\n        - urn:ietf:params:oauth:grant-type:jwt-bearer\n      # Allowed redirect URIs in case you want to use an approuter behind an ingress for user login\n      redirect-uris:\n        - https://*/**\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",metastring:'title="operator-xsuaa-binding.yml"',children:"apiVersion: services.cloud.sap.com/v1alpha1\nkind: ServiceBinding\nmetadata:\n  name: operator-xsuaa-service\nspec:\n  serviceInstanceName: operator-xsuaa-service\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},78989:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var a=t(74848),s=t(28453),r=t(12235);const i={id:"kyma",title:"Migrate your App from SAP BTP CF to Kyma with the SAP Cloud SDK for JavaScript",sidebar_label:"Kubernetes with SAP Kyma",description:"Learn how to migrate your application from SAP BTP Cloud Foundry to Kyma with the SAP Cloud SDK for JavaScript",keywords:["sap","cloud","sdk","cloud native","cloud sdk","sap cloud sdk","kubernetes","kyma"]},o="Getting Started with the SAP Cloud SDK on Kyma",c={id:"environments/kyma",title:"Migrate your App from SAP BTP CF to Kyma with the SAP Cloud SDK for JavaScript",description:"Learn how to migrate your application from SAP BTP Cloud Foundry to Kyma with the SAP Cloud SDK for JavaScript",source:"@site/docs-js/environments/migrate-sdk-application-from-btp-cf-to-kyma.mdx",sourceDirName:"environments",slug:"/environments/kyma",permalink:"/cloud-sdk/docs/js/environments/kyma",draft:!1,unlisted:!1,editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs-js/environments/migrate-sdk-application-from-btp-cf-to-kyma.mdx",tags:[],version:"current",frontMatter:{id:"kyma",title:"Migrate your App from SAP BTP CF to Kyma with the SAP Cloud SDK for JavaScript",sidebar_label:"Kubernetes with SAP Kyma",description:"Learn how to migrate your application from SAP BTP Cloud Foundry to Kyma with the SAP Cloud SDK for JavaScript",keywords:["sap","cloud","sdk","cloud native","cloud sdk","sap cloud sdk","kubernetes","kyma"]},sidebar:"docsJsSidebar",previous:{title:"Kubernetes with SAP Gardener",permalink:"/cloud-sdk/docs/js/environments/kubernetes"},next:{title:"Upgrade to version 3",permalink:"/cloud-sdk/docs/js/guides/upgrade-to-version-3"}},l={},d=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Create and Bind SAP BTP Services",id:"create-and-bind-sap-btp-services",level:3},{value:"Bind the Destination Service",id:"bind-the-destination-service",level:4},{value:"Bind the XSUAA Service",id:"bind-the-xsuaa-service",level:4},{value:"Containerize the Application",id:"containerize-the-application",level:3},{value:"Create a Kyma Deployment using Helm Charts",id:"create-a-kyma-deployment-using-helm-charts",level:2},{value:"Application",id:"application",level:3},{value:"Configure Approuter",id:"configure-approuter",level:3},{value:"Expose the Approuter with an API Rule",id:"expose-the-approuter-with-an-api-rule",level:3},{value:"Access your Application",id:"access-your-application",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://kyma-project.io/docs/kyma/latest/01-overview/",children:"Kyma"})," is an open source project, that offers a comprehensive suite of tools and services, specifically created for the development and operation of cloud-native applications seamlessly integrated with Kubernetes."]}),"\n",(0,a.jsx)(n.h1,{id:"getting-started-with-the-sap-cloud-sdk-on-kyma",children:"Getting Started with the SAP Cloud SDK on Kyma"}),"\n",(0,a.jsxs)(n.p,{children:["This guide helps you migrate your existing application, built with the SAP Cloud SDK for JavaScript, to Kyma.\nThe reference application we will use in this guide can be found in the ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/helm-sample-application",children:"samples repository"}),".\nWe will also deploy an approuter so that only authenticated users can access the application."]}),"\n",(0,a.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Install ",(0,a.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:(0,a.jsx)(n.code,{children:"docker"})})," and ensure access to a publicly reachable Docker repository."]}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsxs)(n.p,{children:["A Kubernetes cluster uses a secret to authenticate with a container registry to pull an image.\nFor that, you will need to ",(0,a.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/#create-a-secret-by-providing-credentials-on-the-command-line",children:"configure a secret in your cluster"}),":"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl create secret docker-registry regcred --docker-server=YOUR_DOCKER_SERVER --docker-username=YOUR_DOCKER_USERNAME --docker-password=YOUR_DOCKER_PASSWORD --docker-email=YOUR_DOCKER_EMAIL\n"})})]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"An SAP BTP Kyma instance created in your subaccount"}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsxs)(n.p,{children:["If you do not have an existing Kyma instance, follow the ",(0,a.jsx)(n.a,{href:"https://help.sap.com/docs/btp/sap-business-technology-platform/create-kyma-environment-instance",children:"documentation"})," to create one."]}),(0,a.jsxs)(n.p,{children:["Once your Kyma environment is created, download the ",(0,a.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/",children:"Kubeconfig"})," file directly from the SAP BTP cockpit.\n",(0,a.jsx)(n.img,{alt:"Kubeconfig file download",src:t(94350).A+"",width:"1573",height:"822"})]})]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/tools/",children:(0,a.jsx)(n.code,{children:"kubectl"})})," configured to work with your SAP BTP, Kyma runtime instance"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://helm.sh/docs/intro/install/",children:(0,a.jsx)(n.code,{children:"helm"})}),", a package manager for Kubernetes"]}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsxs)(n.p,{children:["This guide assumes you have installed the ",(0,a.jsx)(n.a,{href:"https://helm.sh/docs/intro/install/",children:"Helm"})," client and know how to configure and use ",(0,a.jsx)(n.a,{href:"https://helm.sh/docs/topics/charts/",children:"Helm Charts"}),"."]}),(0,a.jsxs)(n.p,{children:["If you are using the ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/helm-sample-application/application",children:"example application"})," from the SDK Samples respository, you can use the existing ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/blob/main/samples/helm-sample-application/helm-chart/k8s-e2e-app-helm-0.1.5.tgz",children:"Helm package"})," and don't need to create all the files again.\nOtherwise, use the code snippets given in this guide as reference and adjust the values accoridng to your application."]})]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"A Node.js application using the SAP Cloud SDK and an approuter"}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["If you do not have an application yet, you can use the ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/helm-sample-application/application",children:"example application"})," and ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/k8s-sample-application/approuter",children:"approuter"}),"."]})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"create-and-bind-sap-btp-services",children:"Create and Bind SAP BTP Services"}),"\n",(0,a.jsx)(n.p,{children:"Now that the service operator is running in your cluster, you can create services just like you would do in SAP BTP CF, but instead of the SAP BTP cockpit, you'll use YAML service definitions.\nFor this guide, we'll assume the application uses two services:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Destination Service"}),"\n",(0,a.jsx)(n.li,{children:"XSUAA Service"}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"bind-the-destination-service",children:"Bind the Destination Service"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Create ",(0,a.jsx)(n.code,{children:"yaml"})," files for the destination service instance and binding:"]}),"\n"]}),"\n",(0,a.jsx)(r.WL,{}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Install the configuration using the commands:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f operator-destination-service.yml\nkubectl apply -f operator-destination-binding.yml\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This should create a Kubernetes secret named ",(0,a.jsx)(n.code,{children:"operator-destination-service"}),".\nThis secret will contain the actual service binding information."]}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsxs)(n.li,{children:["Monitor the status via ",(0,a.jsx)(n.code,{children:"kubectl describe ServiceInstance operator-destination-service"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"bind-the-xsuaa-service",children:"Bind the XSUAA Service"}),"\n",(0,a.jsxs)(n.p,{children:["Create ",(0,a.jsx)(n.code,{children:"yaml"})," files for the XSUAA service instance and binding:"]}),"\n",(0,a.jsx)(r.aQ,{}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsxs)(n.li,{children:["Repeat steps 2 and 3 from the ",(0,a.jsx)(n.a,{href:"#bind-the-destination-service",children:"previous section"})," for the XSUAA service.\nReplace ",(0,a.jsx)(n.code,{children:"destination"})," with ",(0,a.jsx)(n.code,{children:"xsuaa"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["We will see how to mount the created secrets into the file system of the application in the ",(0,a.jsx)(n.a,{href:"#create-a-deployment-configuration",children:"deployment configuration"})," step."]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Notice that the ",(0,a.jsx)(n.code,{children:"metadata -> name"})," property can be anything you want.\nIn this case, it's ",(0,a.jsx)(n.code,{children:"operator-destination-service"}),".\nMake sure it matches exactly to the ",(0,a.jsx)(n.code,{children:"spec -> serviceInstanceName"})," field in the binding."]})}),"\n",(0,a.jsx)(n.h3,{id:"containerize-the-application",children:"Containerize the Application"}),"\n",(0,a.jsxs)(n.p,{children:["Create a ",(0,a.jsx)(n.code,{children:"Dockerfile"})," defining a container for your application.\nThen it can be deployed to one or more Kubernetes Pods."]}),"\n",(0,a.jsx)(r.xV,{}),"\n",(0,a.jsx)(n.p,{children:"Compile and push the image by running:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker build -t <YOUR_REPO>/<YOUR_IMAGE_NAME>:<YOUR_TAG> .\ndocker push <YOUR_REPO>/<YOUR_IMAGE_NAME>:<YOUR_TAG>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-kyma-deployment-using-helm-charts",children:"Create a Kyma Deployment using Helm Charts"}),"\n",(0,a.jsxs)(n.p,{children:["Instead of creating one ",(0,a.jsx)(n.code,{children:"deployment.yml"})," configuration file for all your resources, you will create a Helm Chart that will contain all of the resource definitions necessary to run your application inside of a Kyma cluster."]}),"\n",(0,a.jsxs)(n.p,{children:["A chart, that describes our ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/helm-sample-application/application",children:"example application"})," and ",(0,a.jsx)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/helm-sample-application/application/approuter",children:"approuter"})," is stored as a collection of files inside of ",(0,a.jsxs)(n.a,{href:"https://github.com/SAP-samples/cloud-sdk-js/tree/main/samples/helm-sample-application/helm-chart/k8s-e2e-app-helm",children:[(0,a.jsx)(n.code,{children:"k8s-e2e-app-helm"})," directory"]})," as shown below."]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["For a deeper overview of Helm Charts, refer to the ",(0,a.jsx)(n.a,{href:"https://helm.sh/docs/topics/charts/",children:"development guide"}),"."]})}),"\n",(0,a.jsx)(n.p,{children:"In this section, we'll look into the chart configurations for the following:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"application,"}),"\n",(0,a.jsx)(n.li,{children:"app router,"}),"\n",(0,a.jsx)(n.li,{children:"and the api gateway"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"application",children:"Application"}),"\n",(0,a.jsxs)(n.p,{children:["Create the following files inside the ",(0,a.jsx)(n.code,{children:"app-chart"})," folder:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Chart.yaml"}),": information about the chart"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"values.yaml"}),": the default configuration values for this chart"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"templates\\configmap.yaml"}),": store ",(0,a.jsx)(n.code,{children:"data"})," in key-value pairs. Will be consumed as environment variables in ",(0,a.jsx)(n.code,{children:"deployment.yaml"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"templates\\deployment.yaml"}),": deployment configuration"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"templates\\service.yaml"}),": a ",(0,a.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/",children:"Service"})," to expose the approuter"]}),"\n"]}),"\n",(0,a.jsx)(r.s4,{}),"\n",(0,a.jsx)(n.h3,{id:"configure-approuter",children:"Configure Approuter"}),"\n",(0,a.jsxs)(n.p,{children:["Package the application router as a docker image so that it can run in Kubernetes, refer to the ",(0,a.jsx)(n.a,{href:"https://blogs.sap.com/2020/04/03/sap-application-router/",children:"documentation"})," for configuration details."]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["Refer to the ",(0,a.jsx)(n.a,{href:"#prerequisites",children:"prerequisites"})," if you need to create an simple approuter."]})}),"\n",(0,a.jsxs)(n.p,{children:["Create the same files as described in the section ",(0,a.jsx)(n.a,{href:"#application",children:"above"})," in the ",(0,a.jsx)(n.code,{children:"approuter-charts"})," folder:"]}),"\n",(0,a.jsx)(r.lz,{}),"\n",(0,a.jsx)(n.h3,{id:"expose-the-approuter-with-an-api-rule",children:"Expose the Approuter with an API Rule"}),"\n",(0,a.jsxs)(n.p,{children:["To make the approuter accessible outside of the Kyma cluster, you must expose it using an API Gateway.\nThis can be done by creating an ",(0,a.jsx)(n.a,{href:"https://kyma-project.io/docs/kyma/latest/05-technical-reference/00-custom-resources/apix-01-apirule",children:"API Rule"}),".\nCreate a file named ",(0,a.jsx)(n.code,{children:"api-gateway.yaml"})," inside the ",(0,a.jsx)(n.code,{children:"templates"})," folder with the following content:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",metastring:'title="api-gateway.yaml"',children:'{{- if and (.Values.expose.enabled) (eq .Values.expose.environment "kyma") -}}\n{{- $name := default "approuter-chart" .Values.nameOverride | trunc 63 | trimSuffix "-" -}}\n{{- $fullName := include "k8s-e2e-app-helm.fullname" . -}}\n{{- $svcName := index .Values "approuter-chart" "name" | default (printf "%s-%s-svc" .Release.Name $name) | trunc 63 | trimSuffix "-" | quote -}}\n{{- $svcPort := dig "approuter-chart" "service" "port" 8080 (.Values | merge (dict)) -}}\n\napiVersion: gateway.kyma-project.io/v1beta1\nkind: APIRule\nmetadata:\n  name: {{ $fullName }}-api-rule\n  labels:\n    {{- include "k8s-e2e-app-helm.labels" . | nindent 4 }}\nspec:\n  gateway: kyma-gateway.kyma-system.svc.cluster.local\n  host: {{ index .Values.expose "api-rule" "host" }}\n  service:\n    name: {{ $svcName }}\n    port: {{ $svcPort }}\n  rules:\n    - path: /.*\n      methods:\n        - GET\n        - POST\n        - DELETE\n      mutators: []\n      accessStrategies:\n        - handler: noop\n          config: {}\n\n{{- end }}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Finally, package and deploy all your resources together using the Helm charts created above.\nRun the below command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm package <HELM_CHART_DIRECTORY_PATH> --version v<VERSION_NO> # e.g. v1.0.0\nhelm install e2e-app <PATH_TO_PACKAGED_HELM_CHART>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"access-your-application",children:"Access your Application"}),"\n",(0,a.jsxs)(n.p,{children:["You can view the created resources (application, api rule, etc) by navigating to the Kyma dashboard, using the ",(0,a.jsx)(n.strong,{children:"Link to dashboard"})," link in the subaccount.\nVerify the resources and choose the host link to open the application in your browser."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"API Rule",src:t(70998).A+"",width:"3795",height:"1333"})}),"\n",(0,a.jsx)(n.p,{children:"You should be redirected to the login page of your Idp, if you have configured an approuter."})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},12235:(e,n,t)=>{t.d(n,{WL:()=>d,aQ:()=>u,lz:()=>p,s4:()=>h,xV:()=>l});t(96540);var a=t(36833),s=t(51504),r=t(28747),i=t(1936),o=t(59782),c=t(74848);function l(){return(0,c.jsx)(r.default,{})}function d(){return(0,c.jsx)(i.default,{})}function u(){return(0,c.jsx)(o.default,{})}function p(){return(0,c.jsx)(a.default,{})}function h(){return(0,c.jsx)(s.default,{})}},19365:(e,n,t)=>{t.d(n,{A:()=>i});t(96540);var a=t(34164);const s={tabItem:"tabItem_Ymn6"};var r=t(74848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)(s.tabItem,i),hidden:t,children:n})}},11470:(e,n,t)=>{t.d(n,{A:()=>k});var a=t(96540),s=t(34164),r=t(23104),i=t(56347),o=t(205),c=t(57485),l=t(31682),d=t(89466);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:s}}=e;return{value:n,label:t,attributes:a,default:s}}))}(t);return function(e){const n=(0,l.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const s=(0,i.W6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,c.aZ)(r),(0,a.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(s.location.search);n.set(r,e),s.replace({...s.location,search:n.toString()})}),[r,s])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=p(e),[i,c]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r}))),[l,u]=m({queryString:t,groupId:s}),[f,v]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,r]=(0,d.Dv)(t);return[s,(0,a.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:s}),g=(()=>{const e=l??f;return h({value:e,tabValues:r})?e:null})();(0,o.A)((()=>{g&&c(g)}),[g]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),v(e)}),[u,v,r]),tabValues:r}}var v=t(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function y(e){let{className:n,block:t,selectedValue:a,selectValue:i,tabValues:o}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,r.a_)(),d=e=>{const n=e.currentTarget,t=c.indexOf(n),s=o[t].value;s!==a&&(l(n),i(s))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>c.push(e),onKeyDown:u,onClick:d,...r,className:(0,s.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":a===n}),children:t??n},n)}))})}function j(e){let{lazy:n,children:t,selectedValue:s}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===s));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function b(e){const n=f(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",g.tabList),children:[(0,x.jsx)(y,{...n,...e}),(0,x.jsx)(j,{...n,...e})]})}function k(e){const n=(0,v.A)();return(0,x.jsx)(b,{...e,children:u(e.children)},String(n))}},94350:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/btp-cockpit-kubeconfig-url-c08c8f6e714ad0a4584a974ff370c880.png"},70998:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/kyma-api-rule-429769b826b4aa538d38a965ccf4750e.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var a=t(96540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);